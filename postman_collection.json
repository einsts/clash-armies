{
  "info": {
    "name": "Clash Armies APP API",
    "description": "Clash Armies APP API å®Œæ•´æµ‹è¯•é›†åˆï¼ŒåŒ…å«æ‰€æœ‰æ¥å£çš„æµ‹è¯•ç”¨ä¾‹",
    "schema": "https://schema.getpostman.com/json/collection/v2.1.0/collection.json"
  },
  "variable": [
    { "key": "baseUrl", "value": "http://localhost:5173", "type": "string" },
    { "key": "apiVersion", "value": "v1", "type": "string" },
    { "key": "accessToken", "value": "", "type": "string" },
    { "key": "refreshToken", "value": "", "type": "string" },
    { "key": "userId", "value": "", "type": "string" },
    { "key": "armyId", "value": "", "type": "string" },
    { "key": "commentId", "value": "", "type": "string" }
  ],
  "auth": {
    "type": "bearer",
    "bearer": [ { "key": "token", "value": "{{accessToken}}", "type": "string" } ]
  },
  "item": [
    {
      "name": "ğŸ” è®¤è¯ç›¸å…³",
      "item": [
        {
          "name": "ç”¨æˆ·ç™»å½•",
          "request": {
            "method": "POST",
            "header": [ { "key": "Content-Type", "value": "application/json" } ],
            "body": { "mode": "raw", "raw": "{\n  \"googleIdToken\": \"test_google_token_here\"\n}" },
            "url": { "raw": "{{baseUrl}}/app/api/{{apiVersion}}/auth/login", "host": ["{{baseUrl}}"], "path": ["app", "api", "{{apiVersion}}", "auth", "login"] }
          },
          "event": [
            {
              "listen": "test",
              "script": {
                "type": "text/javascript",
                "exec": [
                  "const j = pm.response.json();",
                  "pm.test('ç™»å½•æˆåŠŸ', () => { pm.expect(j.success).to.be.true; });",
                  "pm.test('è¿”å›Tokenä¸ç”¨æˆ·', () => { pm.expect(j.data).to.have.property('accessToken'); pm.expect(j.data).to.have.property('refreshToken'); pm.expect(j.data).to.have.property('user'); });",
                  "pm.environment.set('accessToken', j.data.accessToken);",
                  "pm.environment.set('refreshToken', j.data.refreshToken);",
                  "if (j.data.user && j.data.user.id) pm.environment.set('userId', j.data.user.id);"
                ]
              }
            }
          ]
        },
        {
          "name": "Tokenåˆ·æ–°",
          "request": {
            "method": "POST",
            "header": [ { "key": "Content-Type", "value": "application/json" } ],
            "body": { "mode": "raw", "raw": "{\n  \"refreshToken\": \"{{refreshToken}}\"\n}" },
            "url": { "raw": "{{baseUrl}}/app/api/{{apiVersion}}/auth/refresh", "host": ["{{baseUrl}}"], "path": ["app", "api", "{{apiVersion}}", "auth", "refresh"] }
          },
          "event": [
            {
              "listen": "test",
              "script": {
                "type": "text/javascript",
                "exec": [
                  "const j = pm.response.json();",
                  "pm.test('åˆ·æ–°æˆåŠŸ', () => { pm.expect(j.success).to.be.true; });",
                  "pm.environment.set('accessToken', j.data.accessToken);",
                  "pm.environment.set('refreshToken', j.data.refreshToken);"
                ]
              }
            }
          ]
        },
        {
          "name": "è·å–ç”¨æˆ·ä¿¡æ¯",
          "request": { "method": "GET", "header": [], "url": { "raw": "{{baseUrl}}/app/api/{{apiVersion}}/users/profile", "host": ["{{baseUrl}}"], "path": ["app", "api", "{{apiVersion}}", "users", "profile"] } },
          "event": [ { "listen": "test", "script": { "type": "text/javascript", "exec": [ "const j = pm.response.json();", "pm.test('è·å–ç”¨æˆ·ä¿¡æ¯', () => { pm.expect(j.success).to.be.true; pm.expect(j.data).to.have.property('user'); });" ] } } ]
        },
        {
          "name": "ç”¨æˆ·ç™»å‡º",
          "request": { 
            "method": "POST", 
            "header": [ { "key": "Content-Type", "value": "application/json" } ], 
            "body": { "mode": "raw", "raw": "{}" },
            "url": { "raw": "{{baseUrl}}/app/api/{{apiVersion}}/auth/logout", "host": ["{{baseUrl}}"], "path": ["app", "api", "{{apiVersion}}", "auth", "logout"] } 
          },
          "event": [ { "listen": "test", "script": { "type": "text/javascript", "exec": [ "const j = pm.response.json();", "pm.test('ç™»å‡ºæˆåŠŸ', () => { pm.expect(j.success).to.be.true; });", "pm.environment.unset('accessToken');", "pm.environment.unset('refreshToken');" ] } } ]
        }
      ]
    },
    {
      "name": "ğŸ—ï¸ å†›é˜Ÿç®¡ç†",
      "item": [
        {
          "name": "è·å–å†›é˜Ÿåˆ—è¡¨",
          "request": {
            "method": "GET",
            "header": [],
            "url": {
              "raw": "{{baseUrl}}/app/api/{{apiVersion}}/armies?page=1&limit=20&townHall=15&sort=new",
              "host": ["{{baseUrl}}"],
              "path": ["app", "api", "{{apiVersion}}", "armies"],
              "query": [ { "key": "page", "value": "1" }, { "key": "limit", "value": "20" }, { "key": "townHall", "value": "15" }, { "key": "sort", "value": "new" } ]
            }
          },
          "event": [ { "listen": "test", "script": { "type": "text/javascript", "exec": [ "const j = pm.response.json();", "pm.test('åˆ—è¡¨æˆåŠŸ', () => { pm.expect(j.success).to.be.true; pm.expect(j.data).to.be.an('array'); });", "if (j.data && j.data.length) pm.environment.set('armyId', j.data[0].id);" ] } } ]
        },
        {
          "name": "åˆ›å»ºå†›é˜Ÿ",
          "request": {
            "method": "POST",
            "header": [ { "key": "Content-Type", "value": "application/json" } ],
            "body": { "mode": "raw", "raw": "{\n  \"name\": \"æµ‹è¯•å†›é˜Ÿ\",\n  \"townHall\": 15,\n  \"banner\": \"test-banner\",\n  \"units\": [ { \"unitId\": 1, \"home\": \"home\", \"amount\": 10 } ],\n  \"equipment\": [ { \"equipmentId\": 1 } ],\n  \"pets\": [ { \"petId\": 1, \"hero\": \"Archer Queen\" } ],\n  \"tags\": [\"attack\", \"defense\"],\n  \"guide\": { \"textContent\": \"å†›é˜Ÿä½¿ç”¨è¯´æ˜\", \"youtubeUrl\": \"https://youtube.com/watch?v=...\" }\n}" },
            "url": { "raw": "{{baseUrl}}/app/api/{{apiVersion}}/armies", "host": ["{{baseUrl}}"], "path": ["app", "api", "{{apiVersion}}", "armies"] }
          },
          "event": [ { "listen": "test", "script": { "type": "text/javascript", "exec": [ "const j = pm.response.json();", "pm.test('åˆ›å»ºæˆåŠŸ', () => { pm.expect(j.success).to.be.true; });", "if (j.data && j.data.armyId) pm.environment.set('armyId', j.data.armyId);" ] } } ]
        },
        {
          "name": "è·å–å†›é˜Ÿè¯¦æƒ…",
          "request": { "method": "GET", "header": [], "url": { "raw": "{{baseUrl}}/app/api/{{apiVersion}}/armies/{{armyId}}", "host": ["{{baseUrl}}"], "path": ["app", "api", "{{apiVersion}}", "armies", "{{armyId}}"] } },
          "event": [ { "listen": "test", "script": { "type": "text/javascript", "exec": [ "const j = pm.response.json();", "pm.test('è¯¦æƒ…æˆåŠŸ', () => { pm.expect(j.success).to.be.true; pm.expect(j.data).to.have.property('id'); });" ] } } ]
        },
        {
          "name": "æ›´æ–°å†›é˜Ÿ",
          "request": {
            "method": "PUT",
            "header": [ { "key": "Content-Type", "value": "application/json" } ],
            "body": { "mode": "raw", "raw": "{\n  \"name\": \"æ›´æ–°åçš„å†›é˜Ÿåç§°\",\n  \"townHall\": 16,\n  \"banner\": \"new-banner\",\n  \"units\": [ { \"unitId\": 1, \"home\": \"home\", \"amount\": 15 } ],\n  \"equipment\": [],\n  \"pets\": [],\n  \"tags\": [\"attack\"],\n  \"guide\": null\n}" },
            "url": { "raw": "{{baseUrl}}/app/api/{{apiVersion}}/armies/{{armyId}}", "host": ["{{baseUrl}}"], "path": ["app", "api", "{{apiVersion}}", "armies", "{{armyId}}"] }
          },
          "event": [ { "listen": "test", "script": { "type": "text/javascript", "exec": [ "const j = pm.response.json();", "pm.test('æ›´æ–°æˆåŠŸ', () => { pm.expect(j.success).to.be.true; });" ] } } ]
        },
        {
          "name": "åˆ é™¤å†›é˜Ÿ",
          "request": { "method": "DELETE", "header": [], "url": { "raw": "{{baseUrl}}/app/api/{{apiVersion}}/armies/{{armyId}}", "host": ["{{baseUrl}}"], "path": ["app", "api", "{{apiVersion}}", "armies", "{{armyId}}"] } },
          "event": [ { "listen": "test", "script": { "type": "text/javascript", "exec": [ "const j = pm.response.json();", "pm.test('åˆ é™¤æˆåŠŸ', () => { pm.expect(j.success).to.be.true; });" ] } } ]
        }
      ]
    },
    {
      "name": "â¤ï¸ äº’åŠ¨åŠŸèƒ½",
      "item": [
        { "name": "ç‚¹èµå†›é˜Ÿ", "request": { "method": "POST", "header": [], "url": { "raw": "{{baseUrl}}/app/api/{{apiVersion}}/armies/{{armyId}}/like", "host": ["{{baseUrl}}"], "path": ["app", "api", "{{apiVersion}}", "armies", "{{armyId}}", "like"] } }, "event": [ { "listen": "test", "script": { "type": "text/javascript", "exec": [ "pm.test('ç‚¹èµæˆåŠŸ', () => pm.expect(pm.response.json().data.action).to.equal('like'));" ] } } ] },
        { "name": "å–æ¶ˆç‚¹èµ", "request": { "method": "DELETE", "header": [], "url": { "raw": "{{baseUrl}}/app/api/{{apiVersion}}/armies/{{armyId}}/like", "host": ["{{baseUrl}}"], "path": ["app", "api", "{{apiVersion}}", "armies", "{{armyId}}", "like"] } }, "event": [ { "listen": "test", "script": { "type": "text/javascript", "exec": [ "pm.test('å–æ¶ˆç‚¹èµ', () => pm.expect(pm.response.json().data.action).to.equal('unlike'));" ] } } ] },
        { "name": "åå‘ç‚¹èµ", "request": { "method": "POST", "header": [], "url": { "raw": "{{baseUrl}}/app/api/{{apiVersion}}/armies/{{armyId}}/dislike", "host": ["{{baseUrl}}"], "path": ["app", "api", "{{apiVersion}}", "armies", "{{armyId}}", "dislike"] } }, "event": [ { "listen": "test", "script": { "type": "text/javascript", "exec": [ "pm.test('åå‘ç‚¹èµ', () => pm.expect(pm.response.json().data.action).to.equal('dislike'));" ] } } ] },
        { "name": "æ”¶è—å†›é˜Ÿ", "request": { "method": "POST", "header": [], "url": { "raw": "{{baseUrl}}/app/api/{{apiVersion}}/armies/{{armyId}}/bookmark", "host": ["{{baseUrl}}"], "path": ["app", "api", "{{apiVersion}}", "armies", "{{armyId}}", "bookmark"] } }, "event": [ { "listen": "test", "script": { "type": "text/javascript", "exec": [ "pm.test('æ”¶è—', () => pm.expect(pm.response.json().data.action).to.equal('bookmark'));" ] } } ] },
        { "name": "è·å–æ”¶è—å†›é˜Ÿåˆ—è¡¨", "request": { "method": "GET", "header": [], "url": { "raw": "{{baseUrl}}/app/api/{{apiVersion}}/armies/bookmarked?page=1&limit=20&sort=new", "host": ["{{baseUrl}}"], "path": ["app", "api", "{{apiVersion}}", "armies", "bookmarked"], "query": [ { "key": "page", "value": "1" }, { "key": "limit", "value": "20" }, { "key": "sort", "value": "new" } ] } }, "event": [ { "listen": "test", "script": { "type": "text/javascript", "exec": [ "const j = pm.response.json();", "pm.test('æ”¶è—åˆ—è¡¨', () => { pm.expect(j.success).to.be.true; pm.expect(j.data).to.be.an('array'); });" ] } } ] }
      ]
    },
    {
      "name": "ğŸ’¬ è¯„è®ºç³»ç»Ÿ",
      "item": [
        {
          "name": "è·å–è¯„è®ºåˆ—è¡¨",
          "request": { "method": "GET", "header": [], "url": { "raw": "{{baseUrl}}/app/api/{{apiVersion}}/armies/{{armyId}}/comments?page=1&limit=20", "host": ["{{baseUrl}}"], "path": ["app", "api", "{{apiVersion}}", "armies", "{{armyId}}", "comments"], "query": [ { "key": "page", "value": "1" }, { "key": "limit", "value": "20" } ] } },
          "event": [ { "listen": "test", "script": { "type": "text/javascript", "exec": [ "const j = pm.response.json();", "pm.test('è¯„è®ºåˆ—è¡¨', () => { pm.expect(j.success).to.be.true; pm.expect(j.data).to.be.an('array'); });" ] } } ]
        },
        {
          "name": "å‘è¡¨è¯„è®º",
          "request": {
            "method": "POST",
            "header": [ { "key": "Content-Type", "value": "application/json" } ],
            "body": { "mode": "raw", "raw": "{\n  \"comment\": \"è¿™æ˜¯ä¸€æ¡æ¥è‡ªAPPçš„æµ‹è¯•è¯„è®º\",\n  \"replyTo\": null\n}" },
            "url": { "raw": "{{baseUrl}}/app/api/{{apiVersion}}/armies/{{armyId}}/comments", "host": ["{{baseUrl}}"], "path": ["app", "api", "{{apiVersion}}", "armies", "{{armyId}}", "comments"] }
          },
          "event": [ { "listen": "test", "script": { "type": "text/javascript", "exec": [ "const j = pm.response.json();", "pm.test('å‘è¡¨è¯„è®º', () => { pm.expect(j.success).to.be.true; pm.expect(j.data).to.have.property('commentId'); });", "if (j.data && j.data.commentId) pm.environment.set('commentId', j.data.commentId);" ] } } ]
        },
        {
          "name": "åˆ é™¤è¯„è®º",
          "request": { "method": "DELETE", "header": [], "url": { "raw": "{{baseUrl}}/app/api/{{apiVersion}}/armies/{{armyId}}/comments?commentId={{commentId}}", "host": ["{{baseUrl}}"], "path": ["app", "api", "{{apiVersion}}", "armies", "{{armyId}}", "comments"], "query": [ { "key": "commentId", "value": "{{commentId}}" } ] } },
          "event": [ { "listen": "test", "script": { "type": "text/javascript", "exec": [ "pm.test('åˆ é™¤è¯„è®º', () => pm.expect(pm.response.json().success).to.be.true);" ] } } ]
        }
      ]
    },
    {
      "name": "ğŸ‘¤ ç”¨æˆ·åå¥½è®¾ç½®",
      "item": [
        { "name": "è·å–ç”¨æˆ·èµ„æ–™", "request": { "method": "GET", "header": [], "url": { "raw": "{{baseUrl}}/app/api/{{apiVersion}}/users/profile", "host": ["{{baseUrl}}"], "path": ["app", "api", "{{apiVersion}}", "users", "profile"] } }, "event": [ { "listen": "test", "script": { "type": "text/javascript", "exec": [ "pm.test('è·å–ç”¨æˆ·èµ„æ–™', () => pm.expect(pm.response.json().success).to.be.true);" ] } } ] },
        { "name": "æ›´æ–°ç”¨æˆ·èµ„æ–™", "request": { "method": "PUT", "header": [ { "key": "Content-Type", "value": "application/json" } ], "body": { "mode": "raw", "raw": "{\n  \"username\": \"newusername\"\n}" }, "url": { "raw": "{{baseUrl}}/app/api/{{apiVersion}}/users/profile", "host": ["{{baseUrl}}"], "path": ["app", "api", "{{apiVersion}}", "users", "profile"] } }, "event": [ { "listen": "test", "script": { "type": "text/javascript", "exec": [ "pm.test('æ›´æ–°èµ„æ–™', () => pm.expect(pm.response.json().success).to.be.true);" ] } } ] }
      ]
    },
    {
      "name": "ğŸ® æ¸¸æˆæ•°æ®",
      "item": [
        { "name": "è·å–å•ä½æ•°æ®", "request": { "method": "GET", "header": [], "url": { "raw": "{{baseUrl}}/app/api/{{apiVersion}}/game/units", "host": ["{{baseUrl}}"], "path": ["app", "api", "{{apiVersion}}", "game", "units"] } }, "event": [ { "listen": "test", "script": { "type": "text/javascript", "exec": [ "pm.test('å•ä½æ•°æ®', () => pm.expect(pm.response.json().success).to.be.true);" ] } } ] },
        { "name": "è·å–è£…å¤‡æ•°æ®", "request": { "method": "GET", "header": [], "url": { "raw": "{{baseUrl}}/app/api/{{apiVersion}}/game/equipment", "host": ["{{baseUrl}}"], "path": ["app", "api", "{{apiVersion}}", "game", "equipment"] } }, "event": [ { "listen": "test", "script": { "type": "text/javascript", "exec": [ "pm.test('è£…å¤‡æ•°æ®', () => pm.expect(pm.response.json().success).to.be.true);" ] } } ] },
        { "name": "è·å–å® ç‰©æ•°æ®", "request": { "method": "GET", "header": [], "url": { "raw": "{{baseUrl}}/app/api/{{apiVersion}}/game/pets", "host": ["{{baseUrl}}"], "path": ["app", "api", "{{apiVersion}}", "game", "pets"] } }, "event": [ { "listen": "test", "script": { "type": "text/javascript", "exec": [ "pm.test('å® ç‰©æ•°æ®', () => pm.expect(pm.response.json().success).to.be.true);" ] } } ] },
        { "name": "è·å–å¤§æœ¬è¥æ•°æ®", "request": { "method": "GET", "header": [], "url": { "raw": "{{baseUrl}}/app/api/{{apiVersion}}/game/townhalls", "host": ["{{baseUrl}}"], "path": ["app", "api", "{{apiVersion}}", "game", "townhalls"] } }, "event": [ { "listen": "test", "script": { "type": "text/javascript", "exec": [ "pm.test('å¤§æœ¬è¥æ•°æ®', () => pm.expect(pm.response.json().success).to.be.true);" ] } } ] }
      ]
    },
    {
      "name": "ğŸ§ª æµ‹è¯•å·¥å…·",
      "item": [ { "name": "å¥åº·æ£€æŸ¥", "request": { "method": "GET", "header": [], "url": { "raw": "{{baseUrl}}/app/health", "host": ["{{baseUrl}}"], "path": ["app", "health"] } }, "event": [ { "listen": "test", "script": { "type": "text/javascript", "exec": [ "pm.response.to.have.status(200);" ] } } ] } ]
    }
  ]
}


